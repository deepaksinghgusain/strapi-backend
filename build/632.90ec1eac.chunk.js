"use strict";(self.webpackChunkmy_project=self.webpackChunkmy_project||[]).push([[632],{632:(N,g,s)=>{s.d(g,{ProtectedEditPage:()=>ts});var a=s(92132),e=s(21272),E=s(94061),P=s(85963),r=s(90151),c=s(68074),C=s(4198),f=s(55356),O=s(38413),D=s(83997),A=s(85829),u=s(21610),t=s(91356),I=s(46270),R=s(54514),T=s(61535),i=s(79275),d=s(54894),_=s(17703),U=s(71389),h=s(48656),l=s(78803),n=s(66248),K=s(82803),F=s(97146),J=s(15126),X=s(63299),M=s(67014),_s=s(59080),ls=s(14718),Es=s(82437),Ms=s(5790),ms=s(35223),Ps=s(5409),cs=s(74930),Os=s(2600),Ds=s(48940),gs=s(41286),As=s(56336),hs=s(13426),vs=s(84624),Ls=s(77965),Cs=s(54257),fs=s(71210),us=s(51187),Is=s(39404),Us=s(58692),Bs=s(501),ps=s(57646),Rs=s(23120),Ts=s(44414),Ks=s(25962),Ws=s(14664),js=s(42588),xs=s(90325),ys=s(62785),Ss=s(87443),zs=s(41032),Ns=s(22957),Fs=s(93179),Ys=s(73055),Vs=s(15747),$s=s(85306),Gs=s(26509),Hs=s(32058),Qs=s(81185),Zs=s(82261),Js=s(55151),Xs=s(79077),bs=s(85071);const q=h.Ik().shape({...F.C,isActive:h.lc(),roles:h.YO().min(1,t.translatedErrors.required).required(t.translatedErrors.required)}),b=["email","firstname","lastname","username","isActive","roles"],ss=()=>{const{formatMessage:o}=(0,d.A)(),B=(0,_.W5)("/settings/users/:id")?.params?.id??"",{push:p}=(0,_.W6)(),m=(0,t.useNotification)(),{lockApp:V,unlockApp:$}=(0,t.useOverlayBlocker)(),w=(0,l.p)(K.M,async()=>(await s.e(3153).then(s.bind(s,43153))).MagicLinkEE),{_unstableFormatAPIError:G,_unstableFormatValidationErrors:es}=(0,t.useAPIErrorHandler)(),k=(0,l.j)(n.s),{isLoading:os,allowedActions:{canUpdate:H}}=(0,t.useRBAC)({read:k.settings?.users.read??[],update:k.settings?.users.update??[]}),[ns]=(0,l.M)();(0,t.useFocusWhenNavigate)();const{data:rs,error:y,isLoading:is}=(0,l.k)({id:B},{refetchOnMountOrArgChange:!0}),[S]=rs?.users??[];if(e.useEffect(()=>{y&&(y.name==="UnauthorizedError"?(m({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}}),p("/")):m({type:"warning",message:{id:"notification.error",defaultMessage:G(y)}}))},[y,G,p,m]),is||!w||os)return(0,a.jsxs)(O.g,{"aria-busy":"true",children:[(0,a.jsx)(t.SettingsPageTitle,{name:"Users"}),(0,a.jsx)(f.Q,{primaryAction:(0,a.jsx)(P.$,{disabled:!0,startIcon:(0,a.jsx)(R.A,{}),type:"button",size:"L",children:o({id:"global.save",defaultMessage:"Save"})}),title:o({id:"app.containers.Users.EditPage.header.label-loading",defaultMessage:"Edit user"}),navigationAction:(0,a.jsx)(u.N,{as:U.NavLink,startIcon:(0,a.jsx)(I.A,{}),to:"/settings/users?pageSize=10&page=1&sort=firstname",children:o({id:"global.back",defaultMessage:"Back"})})}),(0,a.jsx)(C.s,{children:(0,a.jsx)(t.LoadingIndicatorPage,{})})]});const z={...i(S,b),roles:S.roles.map(({id:v})=>v),password:"",confirmPassword:""},ds=async(v,W)=>{V?.();const{confirmPassword:Q,password:j,...Z}=v,L=await ns({id:B,...Z,password:j===""?void 0:j});"error"in L&&(0,l.x)(L.error)?(L.error.name==="ValidationError"&&W.setErrors(es(L.error)),m({type:"warning",message:G(L.error)})):(m({type:"success",message:o({id:"notification.success.saved",defaultMessage:"Saved"})}),W.setValues({...i(v,b),password:"",confirmPassword:""})),$?.()};return(0,a.jsxs)(O.g,{children:[(0,a.jsx)(t.SettingsPageTitle,{name:"Users"}),(0,a.jsx)(T.Formik,{onSubmit:ds,initialValues:z,validateOnChange:!1,validationSchema:q,children:({errors:v,values:W,handleChange:Q,isSubmitting:j,dirty:Z})=>(0,a.jsxs)(t.Form,{children:[(0,a.jsx)(f.Q,{primaryAction:(0,a.jsx)(P.$,{disabled:j||!H?!0:!Z,startIcon:(0,a.jsx)(R.A,{}),loading:j,type:"submit",size:"L",children:o({id:"global.save",defaultMessage:"Save"})}),title:o({id:"app.containers.Users.EditPage.header.label",defaultMessage:"Edit {name}"},{name:z.username||(0,n.g)(z?.firstname??"",z.lastname)}),navigationAction:(0,a.jsx)(u.N,{as:U.NavLink,startIcon:(0,a.jsx)(I.A,{}),to:"/settings/users?pageSize=10&page=1&sort=firstname",children:o({id:"global.back",defaultMessage:"Back"})})}),(0,a.jsxs)(C.s,{children:[S?.registrationToken&&(0,a.jsx)(E.a,{paddingBottom:6,children:(0,a.jsx)(w,{registrationToken:S.registrationToken})}),(0,a.jsxs)(D.s,{direction:"column",alignItems:"stretch",gap:7,children:[(0,a.jsx)(E.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,a.jsxs)(D.s,{direction:"column",alignItems:"stretch",gap:4,children:[(0,a.jsx)(A.o,{variant:"delta",as:"h2",children:o({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"Details"})}),(0,a.jsx)(r.x,{gap:5,children:as.map(L=>L.map(x=>(0,a.jsx)(c.E,{...x.size,children:(0,a.jsx)(t.GenericInput,{...x,disabled:!H,error:v[x.name],onChange:Q,value:W[x.name]})},x.name)))})]})}),(0,a.jsx)(E.a,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:(0,a.jsxs)(D.s,{direction:"column",alignItems:"stretch",gap:4,children:[(0,a.jsx)(A.o,{variant:"delta",as:"h2",children:o({id:"global.roles",defaultMessage:"User's role"})}),(0,a.jsx)(r.x,{gap:5,children:(0,a.jsx)(c.E,{col:6,xs:12,children:(0,a.jsx)(K.S,{disabled:!H,error:v.roles,onChange:Q,value:W.roles})})})]})})]})]})]})})]})},as=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12},required:!0},{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},name:"username",placeholder:{id:"Auth.form.username.placeholder",defaultMessage:"e.g. Kai_Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"global.password",defaultMessage:"Password"},name:"password",type:"password",size:{col:6,xs:12},autoComplete:"new-password"},{intlLabel:{id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"},name:"confirmPassword",type:"password",size:{col:6,xs:12},autoComplete:"new-password"}],[{intlLabel:{id:"Auth.form.active.label",defaultMessage:"Active"},name:"isActive",type:"bool",size:{col:6,xs:12}}]],ts=()=>{const o=(0,t.useNotification)(),Y=(0,l.j)(n.s),{isLoading:B,allowedActions:{canRead:p,canUpdate:m}}=(0,t.useRBAC)({read:Y.settings?.users.read??[],update:Y.settings?.users.update??[]}),{state:V}=(0,_.zy)(),$=V?.from??"/";return e.useEffect(()=>{B||!p&&!m&&o({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}})},[B,p,m,o]),B?(0,a.jsx)(t.LoadingIndicatorPage,{}):!p&&!m?(0,a.jsx)(_.rd,{to:$}):(0,a.jsx)(ss,{})}},82803:(N,g,s)=>{s.d(g,{M:()=>u,S:()=>t,a:()=>A});var a=s(92132),e=s(54894),E=s(78803),P=s(88353),r=s(56654),c=s(91356),C=s(90625),f=s(84795),O=s(63891),D=s(85071);const A=({children:i,target:d})=>{const _=(0,c.useNotification)(),{formatMessage:U}=(0,e.A)(),{copy:h}=(0,c.useClipboard)(),l=U({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),n=async()=>{await h(d)&&_({type:"info",message:{id:"notification.link-copied"}})};return(0,a.jsx)(c.ContentBox,{endAction:(0,a.jsx)(P.K,{label:l,noBorder:!0,icon:(0,a.jsx)(C.A,{}),onClick:n}),title:d,titleEllipsis:!0,subtitle:i,icon:(0,a.jsx)("span",{style:{fontSize:32},children:"\u2709\uFE0F"}),iconBackground:"neutral100"})},u=({registrationToken:i})=>{const{formatMessage:d}=(0,e.A)(),_=`${window.location.origin}${(0,E.K)()}/auth/register?registrationToken=${i}`;return(0,a.jsx)(A,{target:_,children:d({id:"app.components.Users.MagicLink.connect",defaultMessage:"Copy and share this link to give access to this user"})})},t=({disabled:i,error:d,onChange:_,value:U})=>{const{isLoading:h,roles:l}=(0,D.u)(),{formatMessage:n}=(0,e.A)(),K=d?n({id:d,defaultMessage:d}):"",F=n({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),J=n({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"A user can have one or several roles"}),X=n({id:"app.components.Select.placeholder",defaultMessage:"Select"});return(0,a.jsx)(r.KF,{id:"roles",disabled:i,error:K,hint:J,label:F,name:"roles",onChange:M=>{_({target:{name:"roles",value:M}})},placeholder:X,startIcon:h?(0,a.jsx)(T,{}):void 0,value:U.map(M=>M.toString()),withTags:!0,required:!0,children:l.map(M=>(0,a.jsx)(r.fe,{value:M.id.toString(),children:n({id:`global.${M.code}`,defaultMessage:M.name})},M.id))})},I=(0,O.keyframes)`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(359deg);
  }
`,R=O.default.div`
  animation: ${I} 2s infinite linear;
`,T=()=>(0,a.jsx)(R,{children:(0,a.jsx)(f.A,{})})},85071:(N,g,s)=>{s.d(g,{u:()=>r});var a=s(21272),e=s(91356),E=s(54894),P=s(78803);const r=(c={},C)=>{const{locale:f}=(0,E.A)(),O=(0,e.useCollator)(f,{sensitivity:"base"}),{data:D,error:A,isError:u,isLoading:t,refetch:I}=(0,P.z)(c,C);return{roles:a.useMemo(()=>[...D??[]].sort((T,i)=>O.compare(T.name,i.name)),[D,O]),error:A,isError:u,isLoading:t,refetch:I}}},97146:(N,g,s)=>{s.d(g,{C:()=>E});var a=s(91356),e=s(48656);const E={firstname:e.Yj().trim().required(a.translatedErrors.required),lastname:e.Yj(),email:e.Yj().email(a.translatedErrors.email).lowercase().required(a.translatedErrors.required),username:e.Yj().nullable(),password:e.Yj().min(8,a.translatedErrors.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:e.Yj().min(8,a.translatedErrors.minLength).oneOf([e.KR("password"),null],"components.Input.error.password.noMatch").when("password",(P,r)=>P?r.required(a.translatedErrors.required):r)}}}]);
